"use strict";var e=require("../../../common/vendor.js");const t={data:()=>({id:null,userName:null,item:null}),onLoad(){if(!e.index.getStorageSync("token")){if(getCurrentPages().length<2)return void e.index.navigateTo({url:"/pages/ucenter/ucenter"});e.index.navigateBack()}this.getUserInfo()},methods:{getUserInfo(){let t=e.index.getStorageSync("token");e.pn.callFunction({name:"fun",data:{api:"getUserInfo",token:t}}).then((e=>{if(!e.result.success)throw Error(e.errorMessage);this.id=e.result.data.id,this.userName=e.result.data.userName})).catch((t=>{console.log(t),e.index.showToast({icon:"none",title:"获取失败"})}))},inputDialogToggle(){this.$refs.inputDialog.open()},dialogInputConfirm(t){if(!this.item)return e.index.showToast({icon:"error",title:"对象错误, 请重试"}),void(this.item=null);if(!t.trim())return e.index.showToast({icon:"error",title:"请输入有效值"}),void(this.item=null);let i=e.index.getStorageSync("token");e.pn.callFunction({name:"fun",data:{api:"updateUserInfo",args:{item:this.item,val:t},token:i}}).then((t=>{if(!t.result.success)throw Error(t.result.errorMessage);e.index.showToast({icon:"success",title:"修改成功"}),this.getUserInfo()})).catch((t=>{console.log(t),e.index.showToast({icon:"error",title:"修改失败"})})),this.item=""},changeUserName(){this.item="userName",this.inputDialogToggle()},changePassword(){this.item="password",this.inputDialogToggle()}}};if(!Array){(e.resolveComponent("uni-list-item")+e.resolveComponent("uni-list")+e.resolveComponent("uni-popup-dialog")+e.resolveComponent("uni-popup"))()}Math||((()=>"../../../uni_modules/uni-list/components/uni-list-item/uni-list-item.js")+(()=>"../../../uni_modules/uni-list/components/uni-list/uni-list.js")+(()=>"../../../uni_modules/uni-popup/components/uni-popup-dialog/uni-popup-dialog.js")+(()=>"../../../uni_modules/uni-popup/components/uni-popup/uni-popup.js"))();var i=e._export_sfc(t,[["render",function(t,i,n,o,s,r){return{a:e.o((e=>r.changeUserName())),b:e.p({title:"用户名",rightText:s.userName,clickable:!0}),c:e.o((e=>r.changePassword())),d:e.p({title:"密码",rightText:"点此修改",clickable:!0}),e:e.p({title:"id",rightText:s.id}),f:e.sr("inputClose","5b0ee4ec-5,5b0ee4ec-4"),g:e.o(r.dialogInputConfirm),h:e.p({mode:"input",title:"修改内容",placeholder:"请输入修改后想要的内容"}),i:e.sr("inputDialog","5b0ee4ec-4"),j:e.p({type:"dialog"})}}]]);wx.createPage(i);
